<Window x:Class="WebApplications.Utilities.Service.Client.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Input.Toolkit"
        Title="MainWindow" 
        Height="900" 
        Width="1024"
        MinHeight="260"
        MinWidth="580"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResizeWithGrip"
        Background="#AA000000" WindowStartupLocation="CenterScreen"
        Margin="10" 
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        MouseDoubleClick="Window_MouseDoubleClick" MouseLeftButtonUp="Window_MouseLeftButtonUp" MouseMove="Window_MouseMove">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- Dark Theme -->
                <ResourceDictionary Source="Themes/Metro/Dark/MetroDark.MSControls.Core.Implicit.xaml" />
                <ResourceDictionary Source="Themes/Metro/Dark/MetroDark.MSControls.Toolkit.Implicit.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <Grid>
        <Grid.Resources>
            <Style  x:Key="HistoryStyle" TargetType="ListBoxItem">
                <Setter Property="Margin" Value="0" />
                <Setter Property="Padding" Value="0" />
                <Setter Property="FontFamily" Value="Consolas" />
                <Setter Property="FontSize" Value="12" />
            </Style>
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="96*" MinHeight="188"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition  Height="4*" MinHeight="38"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width ="100"/>
        </Grid.ColumnDefinitions>
        <Label Name="TitleLabel" Foreground="White" FontWeight="Bold">Service Client for Babel API</Label>
        <Button Name="CloseButton" Grid.Column="1" Margin="0" HorizontalAlignment="Right" BorderThickness="0" Click="Close_Click">X</Button>
        <RichTextBox Name="LogView" 
                     Grid.Row="1" 
                     Grid.Column="0" 
                     Margin="0"
                     HorizontalAlignment="Stretch"
                     ScrollViewer.VerticalScrollBarVisibility="Visible"
                     ScrollViewer.HorizontalScrollBarVisibility="Auto"
                     Style="{StaticResource LogRichTextBoxStyle}"
                     Grid.ColumnSpan="2" 
                     Background="{StaticResource BackgroundKey}" 
                     IsReadOnly="True">
            <RichTextBox.Resources>
                <Style TargetType="{x:Type Paragraph}">
                    <Setter Property="Margin" Value="0"/>
                    <Setter Property="FontFamily" Value="Consolas"/>
                </Style>
            </RichTextBox.Resources>
        </RichTextBox>
        <GridSplitter Grid.Row="2" Grid.Column="0"  Grid.ColumnSpan="2" Height="4"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Center" 
              MaxHeight="4"
              ShowsPreview="true"/>
        <controls:AutoCompleteBox
            Name="CommandLine"
            Margin="4" 
            Grid.Row="3"
            Grid.Column="0" 
            Height="Auto" 
            FilterMode="Contains"
            IsTextCompletionEnabled="True"
            ItemContainerStyle="{StaticResource HistoryStyle}"
            VerticalAlignment="Stretch"
            ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=History}"
            MaxDropDownHeight="200" MinimumPrefixLength="0" KeyUp="CommandLine_KeyUp"/>
        
        <Button Name="Execute"
                Grid.Row="3"
                Grid.Column="1"
                Margin="4,4,20,4" 
                Click="Execute_Click" 
                VerticalAlignment="Stretch"
                IsDefault="{Binding ElementName=CommandLine, Path=IsKeyboardFocused}">Execute</Button>
    </Grid>
</Window>
